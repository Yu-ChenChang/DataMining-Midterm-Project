%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Programming/Coding Assignment
% LaTeX Template
%
% This template has been downloaded from:
% http://www.latextemplates.com
%
% Original author:
% Ted Pavlic (http://www.tedpavlic.com)
%
% Note:
% The \lipsum[#] commands throughout this template generate dummy text
% to fill the template out. These commands should all be removed when 
% writing assignment content.
%
% This template uses a Perl script as an example snippet of code, most other
% languages are also usable. Configure them in the "CODE INCLUSION 
% CONFIGURATION" section.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage[usenames,dvipsnames]{color} % Required for custom colors
\usepackage{graphicx} % Required to insert images
\usepackage{listings} % Required for insertion of code
\usepackage{courier} % Required for the courier font
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
\usepackage[T1]{fontenc}
\usepackage{amsmath, amsthm, amssymb}
\usepackage[ansinew]{inputenc}
\usepackage{pdfpages}
\usepackage{minted}
\usepackage{enumerate}
\usepackage{adjustbox}

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1} % Line spacing

% Set up the header and footer
\pagestyle{fancy}
\lhead{\hmwkAuthorName} % Top left header
\chead{\hmwkClass\ \hmwkTitle} % Top center head
\rhead{\firstxmark} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \protect\pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{0pt} % Removes all indentation from paragraphs

%----------------------------------------------------------------------------------------
%	CODE INCLUSION CONFIGURATION
%----------------------------------------------------------------------------------------

\definecolor{MyDarkGreen}{rgb}{0.0,0.4,0.0} % This is the color used for comments
\lstloadlanguages{Perl} % Load Perl syntax for listings, for a list of other languages supported see: ftp://ftp.tex.ac.uk/tex-archive/macros/latex/contrib/listings/listings.pdf
\lstset{language=Perl, % Use Perl in this example
        frame=single, % Single frame around code
        basicstyle=\small\ttfamily, % Use small true type font
        keywordstyle=[1]\color{Blue}\bf, % Perl functions bold and blue
        keywordstyle=[2]\color{Purple}, % Perl function arguments purple
        keywordstyle=[3]\color{Blue}\underbar, % Custom functions underlined and blue
        identifierstyle=, % Nothing special about identifiers                                         
        commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small, % Comments small dark green courier font
        stringstyle=\color{Purple}, % Strings are purple
        showstringspaces=false, % Don't put marks in string spaces
        tabsize=5, % 5 spaces per tab
        %
        % Put standard Perl functions not included in the default language here
        morekeywords={rand},
        %
        % Put Perl function parameters here
        morekeywords=[2]{on, off, interp},
        %
        % Put user defined functions here
        morekeywords=[3]{test},
       	%
        morecomment=[l][\color{Blue}]{...}, % Line continuation (...) like blue comment
        numbers=left, % Line numbers on left
        firstnumber=1, % Line numbers start with line 1
        numberstyle=\tiny\color{Blue}, % Line numbers are blue and small
        stepnumber=5 % Line numbers go in steps of 5
}

% Creates a new command to include a perl script, the first parameter is the filename of the script (without .pl), the second parameter is the caption
%%\newcommand{\perlscript}[2]{
%%\begin{itemize}
%%\item[]\lstinputlisting[caption=#2,label=#1]{#1.pl}
%%\end{itemize}
%%}

%----------------------------------------------------------------------------------------
%	DOCUMENT STRUCTURE COMMANDS
%	Skip this unless you know what you're doing
%----------------------------------------------------------------------------------------

% Header and footer for when a page split occurs within a problem environment
\newcommand{\enterProblemHeader}[1]{
\nobreak\extramarks{#1}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
}

% Header and footer for when a page split occurs between problem environments
\newcommand{\exitProblemHeader}[1]{
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1}{}\nobreak
}

\setcounter{secnumdepth}{0} % Removes default section numbers
\newcounter{homeworkProblemCounter} % Creates a counter to keep track of the number of problems

\newcommand{\homeworkProblemName}{}
\newenvironment{homeworkProblem}[1][Problem \arabic{homeworkProblemCounter}]{ % Makes a new environment called homeworkProblem which takes 1 argument (custom name) but the default is "Problem #"
\stepcounter{homeworkProblemCounter} % Increase counter for number of problems
\renewcommand{\homeworkProblemName}{#1} % Assign \homeworkProblemName the name of the problem
\section{\homeworkProblemName} % Make a section in the document with the custom problem count
\enterProblemHeader{\homeworkProblemName} % Header and footer within the environment
}{
\exitProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

\newcommand{\problemAnswer}[1]{ % Defines the problem answer command with the content as the only argument
\noindent\framebox[\columnwidth][c]{\begin{minipage}{0.98\columnwidth}#1\end{minipage}} % Makes the box around the problem answer and puts the content inside
}

\newcommand{\homeworkSectionName}{}
\newenvironment{homeworkSection}[1]{ % New environment for sections within homework problems, takes 1 argument - the name of the section
\renewcommand{\homeworkSectionName}{#1} % Assign \homeworkSectionName to the name of the section from the environment argument
\subsection{\homeworkSectionName} % Make a subsection with the custom name of the subsection
\enterProblemHeader{\homeworkProblemName\ [\homeworkSectionName]} % Header and footer within the environment
}{
\enterProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{Midterm} % Assignment title
\newcommand{\hmwkDueDate}{March\ 11,\ 2016} % Due date
\newcommand{\hmwkClass}{Data Mining\ CS573} % Course/class
\newcommand{\hmwkAuthorName}{Yu-Chen Chang} % Your name

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title{
\vspace{2in}
\textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
\normalsize\vspace{0.1in}\small{\hmwkDueDate}\\
\vspace{3in}
}

\author{\textbf{\hmwkAuthorName}}
\date{} % Insert date here if you want it to appear below your name

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle

%----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS
%----------------------------------------------------------------------------------------

%\setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC

\newpage
\tableofcontents
\newpage

%----------------------------------------------------------------------------------------
%	PROBLEM 1
%----------------------------------------------------------------------------------------

% To have just one problem per page, simply put a \clearpage after each problem

\begin{homeworkProblem}
\begin{enumerate}[a.]
% NBC
\item \ 
	\begin{enumerate}[i.]
	%a-i
	\item Naive Bayes Classifier: \\ \\
	From the naive bayes classifier, we have the formula: \\
	$P(C|X) = \frac{P(X|C)P(C)}{P(X)} \propto P(X|C)P(C)$ (Bayes rule), where C is the class random variable and X is the attribute random vector. \\ \\
	In NBC, there is an assumption that attributes are conditionally independent given the class, Therefore, we have the naive Bayes classifier: \\
	$P(C|X) \propto P(X|C)P(C) \propto \prod_{i=1}^{m}P(X_{i}|C)P(C)$ , where m is the number of attributes and $X_i$ is the $i$-th attribute random variable.\\ \\
	Because we don't know the distribution of $P(X_{i}|C)$ and $P(C)$,
	Therefore, we need likelihood function to determine unknown parameters based on known outcomes. Assume the data D are independently sampled from the same distribution. Let $D = [x_1, ... , x_n]$, where n is the number of samples:
	\begin{align}
	L(\theta|D) &= \prod_{i=1}^{n}P(x_{i},c_{i}|\theta) \text{\ \ (general likelihood)}\\
	&\propto \prod_{i=1}^{n}P(x_{i}|c_{i},\theta)P(c_i|\theta) \text{\ \ (Bayes rule)}\\ 
	&\propto \prod_{i=1}^{n} \prod_{j=1}^{m}P(x_{ij}|c_{i},\theta)P(c_i|\theta) \text{\ \ (Naive assumption)}
	\end{align}
	We apply Maximum Likelihood estimation to learn the best parameters by finding the value $\theta$ that maximizes likelihood:
	\begin{align}
	\hat{\theta}_{MLE} = arg\underset{\theta}{max}L(\theta)
	\end{align}
	For Multinomials, Let $A \in \{1,...,k\}$ be a discrete random variable with k values, where $P(A=j) = \theta_j$. Then P(A) is a multinomial distribution:\\
	\begin{align}
	P(A|\theta) = \prod_{j=1}^{k}\theta_{j}^{I(A=j)} \text{\ ,\ where $I(A=j)$ is an indicator function.}
	\end{align}
	The likelihood for a data set D is:
	\begin{align}
	P(D|\theta) = \prod_{i=1}^{n}\prod_{j=1}^{k}\theta_{j}^{I(A=j)} = \prod_{j}\theta_i^{n_j}
	\end{align}
	Therefore, by using Lagrange multipliers, the maximum likelihood estimates for each parameter are:
	\begin{align}
	\hat{\theta_j} = \frac{n_j}{n}
	\end{align}
	which means that in multinomial case, MLE can be determined analytically by counting. \\ \\
	For continuous inputs $X_i$, the common way to represent the distributions $P(X_i|Y)$ to assume that for each possible discrete value $y_k$ of Y, the distribution of each continuous $X_i$ is Gaussian, and is defined by a mean and standard deviation specific to $X_i$ and $y_k$.
	\begin{align}
	\mu_{ik} &= E[X_i|Y=y_k] \\
	\sigma_{ik}^{2} &= E[(X_i-\mu_{ik})^2|Y=y_k] 
	\end{align}
	Again, by MLE, we get: \\
	\begin{align}
	\hat\mu_{ik} &= \frac{1}{\sum_{j}\delta(Y^j=y_k)}\sum_{j}X_i^j\delta(Y^j=y_k) \\
	\hat\sigma_{ik}^{2} &= \frac{1}{\sum_{j}\delta(Y^j=y_k)}\sum_{j}(X_i^j-\hat{\mu_{ik}})^2\delta(Y^j=y_k)
	\end{align}
	Then we can estimate continuous attributes using Gaussian distribution with $\hat\mu_{ik}$ and $\hat\sigma_{ik}^{2}$. \\
	
	In this question, we are given 11 attributes.
	\begin{enumerate}[1.]
	\item Record Number
	\item Amount Requested
	\item Interest Rate Percentage
	\item Loan Length in Months
	\item Loan Title
	\item Loan Purpose
	\item Monthly Payment
	\item Total Amount Funded
	\item Debt-To-Income Ratio Percentage
	\item FICO Range
	\item Status
	\end{enumerate}
	The Record Number is used as id and will not be considered as an attribute and Status is the classification goal that we are interested in and used as the class random variable. Therefore, the potential attributes are from the 2 to 10 entry, which forms our attribute random vector. \\ \\
	In the step of classifying out-of-sample items, we will use the above shown formula to calculate the P(C|X) and compare $P(C=c_1|X)$ with $P(C=c_2|X)$ to see whether the out-of-sample with its attributes given in X should belong to $c_1$ or $c_2$ class.
	\item From the MLE, we have the formula 
	\begin{align}
	\hat{\theta_j} = \frac{n_j}{n}
	\end{align}
	The prior is estimated from the dataset by counting the number of each class among the entire dataset. However, if the real value prior is far from the estimated one, it will have significant impacts on the correctness of the prediction. For example, if we have a dataset with half of people with cancer and other half are healthy while in really life the probability that a person has a cancer is nearly 0.01\%, then in this situation the prior will be estimated wrong (50\%), which should be 0.01\% for cancer class and 99.99\% for healthy class, and cause large false positive in this prediction. Therefore, we can see that the wrong prior in NBC will cause either false positive or false negative to increase depending on the difference between real prior and the estimated one. That's the reason why prior in NBC is important. 
	\end{enumerate}
\end{enumerate}
\end{homeworkProblem}
\clearpage
%----------------------------------------------------------------------------------------
%	PROBLEM 2
%----------------------------------------------------------------------------------------

\begin{homeworkProblem}
\begin{enumerate}[a.]
\item \ 

\item \
	
\end{enumerate}
\end{homeworkProblem}
\clearpage
%----------------------------------------------------------------------------------------

\end{document}